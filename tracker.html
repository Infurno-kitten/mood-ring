<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mood Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { font-family: Arial, sans-serif; background: #f0f0f0; }
  .container { max-width: 500px; margin: 20px auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #aaa; }
  input, select, button { margin: 5px 0; padding: 5px; width: 100%; }
</style>
</head>
<body>

<div class="container">
  <h2>Mood Tracker</h2>
  
  <label>Mood:</label>
  <select id="mood">
    <option value="😄">😄 Happy</option>
    <option value="🙂">🙂 Content</option>
    <option value="😐">😐 Neutral</option>
    <option value="😟">😟 Anxious</option>
    <option value="😢">😢 Sad</option>
    <option value="😡">😡 Angry</option>
  </select>
  
  <label>Intensity (1-100):</label>
  <input type="number" id="intensity" min="1" max="100">
  
  <label>Trigger:</label>
  <input type="text" id="trigger" placeholder="What caused this mood?">
  
  <label>Coping Strategy:</label>
  <input type="text" id="coping" placeholder="What did you do to cope?">
  
  <button onclick="saveMood()">Save Mood</button>
  <button onclick="logout()">Logout</button>
  
  <hr>
  <canvas id="moodChart"></canvas>
</div>

<script>
window.onload = function() {
  const user = localStorage.getItem('user');
  if(!user) window.location.href = 'login.html';
  loadChart();
}

function logout() {
  localStorage.removeItem('user');
  window.location.href = 'login.html';
}

function saveMood() {
  const mood = document.getElementById('mood').value;
  const intensity = parseInt(document.getElementById('intensity').value);
  const trigger = document.getElementById('trigger').value;
  const coping = document.getElementById('coping').value;
  if(!intensity || !mood) { alert('Mood and intensity are required'); return; }

  let moods = JSON.parse(localStorage.getItem('moods') || '[]');
  moods.push({ date: new Date().toLocaleString(), mood, intensity, trigger, coping });
  localStorage.setItem('moods', JSON.stringify(moods));
  alert('Mood saved!');
  loadChart();
}

function loadChart() {
  const moods = JSON.parse(localStorage.getItem('moods') || '[]');
  const labels = moods.map(m => m.date);
  const data = moods.map(m => m.intensity);
  const ctx = document.getElementById('moodChart').getContext('2d');
  if(window.moodChart) window.moodChart.destroy();
  window.moodChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [{
        label: 'Mood Intensity',
        data: data,
        borderColor: 'blue',
        backgroundColor: 'lightblue',
        tension: 0.3
      }]
    },
    options: { scales: { y: { min: 0, max: 100 } } }
  });
}
</script>

</body>
</html>
